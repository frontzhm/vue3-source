# 6. 依赖清理流程

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526094721751.png" alt="image-20230526094721751" style="zoom:50%;" />

debugger走一遍，，理解effect的收集原理。

数据变化的话收集的effect就执行。



deps为什么记录属性。

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526095618778.png" alt="image-20230526095618778" style="zoom:50%;" />

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526095804879.png" alt="image-20230526095804879" style="zoom:50%;" />



<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526095928037.png" alt="image-20230526095928037" style="zoom:50%;" />





每次fn在执行前，先进行清理

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526100202653.png" alt="image-20230526100202653" style="zoom:50%;" />

effect找到属性对应的列表中，在收集的列表中

先去收集falg name

flag变成false。移除name的effect

重新收集age



<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526100553875.png" alt="image-20230526100553875" style="zoom:50%;" />



更新了就重新收集关系

拿到最新的依赖收集更新就好了



代码死机了。



<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526100835860.png" alt="image-20230526100835860" style="zoom:50%;" />



死循环了。

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526100916263.png" alt="image-20230526100916263" style="zoom:50%;" />

同这个。



同一个set不要同时 增加删除，遍历

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526101011039.png" alt="image-20230526101011039" style="zoom:50%;" />

加了一层。

<img src="/Users/zhm/Library/Application Support/typora-user-images/image-20230526101109392.png" alt="image-20230526101109392" style="zoom:50%;" />











































